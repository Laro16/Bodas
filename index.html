<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Invitación de Boda · Isabel & Alejandro</title>
  <meta name="description" content="Una invitación de boda digital elegante, con un diseño profesional y moderno." />
  <meta name="theme-color" content="#fbf9f6" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins:wght@300;400;600&family=Dancing+Script:wght@500&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand:#a88552;          /* Oro principal */
      --brand-light: #e6d8c3;   /* Oro claro */
      --ink:#2c2c2c;            /* Texto principal (casi negro) */
      --muted:#7d7d7d;          /* Texto secundario */
      --accent: #1e413a;        /* Verde esmeralda profundo */
      --bg:#fbf9f6;             /* Fondo (blanco hueso) */
      --card:#ffffff;           /* Tarjetas (blanco puro) */
      --radius: 16px;            /* Radios globales */
      --maxw: 900px;             /* Ancho máximo del contenido */
      --shadow-soft: 0 4px 12px rgba(0,0,0,.05);
      --shadow-medium: 0 8px 24px rgba(0,0,0,.08);
      --transition: all .3s cubic-bezier(.25,.8,.25,1);
    }

    /* === RESETS Y GLOBALES === */
    *{box-sizing:border-box}
    html{scroll-behavior: smooth;}
    body{
      margin:0; 
      color:var(--ink);
      font-family:'Poppins', sans-serif;
      font-weight: 300;
      line-height:1.7;
      background-color: var(--bg);
      -webkit-font-smoothing:antialiased; 
      -moz-osx-font-smoothing:grayscale;
      overflow-x:hidden;
    }
    img{max-width:100%; display:block; border-radius: var(--radius);}
    ul,ol{margin:0; padding:0; list-style:none}
    a{color:var(--brand); text-decoration:none; transition: var(--transition);}
    a:hover{color:var(--accent);}
    .wrap{max-width:var(--maxw); margin:0 auto; padding:0 24px;}
    .title{
      font-family:'Playfair Display', serif; 
      font-weight:600; 
      font-size:clamp(32px, 6vw, 48px); 
      margin:0 0 10px; text-align:center; 
      line-height: 1.2;
      color: var(--accent);
    }
    .subtitle{
      color:var(--muted); 
      text-align:center; 
      margin:-2px auto 40px; 
      max-width:600px;
      font-size: 1.1rem;
    }

    /* === HERO === */
    header.hero{
      min-height:90svh; 
      display:flex; flex-direction: column; justify-content: center;
      text-align:center; position:relative; overflow:hidden; color:#fff;
      padding: 40px 0;
      background:
        linear-gradient(to top, rgba(30, 65, 58, 0.7), rgba(30, 65, 58, 0.3) 60%, transparent),
        url('assets/imagenes/hero-portada.jpg') center/cover no-repeat;
    }
    header .badge{
      display:inline-block; padding:.4rem 1rem; 
      font-weight:600; letter-spacing:.1em; text-transform:uppercase; font-size:.75rem;
      background:rgba(255,255,255,.15);
      border:1px solid rgba(255,255,255,.3); 
      border-radius:999px; backdrop-filter: blur(5px);
      color: #fff;
    }
    header h1{
      font-family:'Playfair Display',serif; font-weight:600;
      font-size:clamp(48px, 10vw, 90px); 
      margin:1rem 0 .5rem; line-height:1.05;
      text-shadow:0 3px 15px rgba(0,0,0,.3);
      color: #fff;
    }
    header p.sub{color:#f0f0f0; margin:.5rem 0 1.5rem; font-size: 1.1rem;}

    /* === COUNTDOWN === */
    .countdown{display:flex; justify-content:center; gap:12px; margin:24px auto;}
    .time-box{
      min-width:80px; border-radius:var(--radius); padding:12px; text-align:center; color:#fff;
      background:rgba(255,255,255,.1);
      border:1px solid rgba(255,255,255,.25);
      box-shadow:var(--shadow-soft);
      backdrop-filter: blur(8px);
    }
    .time-box .num{font-size:clamp(28px, 5vw, 36px); font-weight:600; display:block; line-height:1.1;}
    .time-box .label{font-size:11px; opacity:.8; letter-spacing:.08em; text-transform:uppercase}

    /* === BOTONES (REFINADOS) === */
    .cta-row{display:flex; gap:.8rem; justify-content:center; flex-wrap:wrap; margin-top: 24px;}
    .btn{
      appearance:none; border: 1.5px solid;
      background: transparent; color: inherit; 
      font-weight:600; font-size: 1rem;
      padding:.8rem 1.5rem; border-radius:999px; cursor:pointer; 
      transition: var(--transition);
      display:inline-flex; align-items:center; gap:.6rem;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: .05em;
    }
    .btn.primary {
      background-color: var(--brand);
      border-color: var(--brand);
      color: #fff;
      box-shadow: var(--shadow-soft);
    }
    .btn.primary:hover {
      background-color: #947244;
      border-color: #947244;
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }
    .btn.secondary {
      border-color: rgba(255,255,255,.5);
      color: #fff;
    }
    .btn.secondary:hover {
      background-color: rgba(255,255,255,.1);
      border-color: #fff;
    }
    .btn svg { width: 18px; height: 18px; }

    /* NUEVO: Estilo especial para los botones con letra cursiva */
    #btnWhatsapp,
    #btnEscuchar {
      font-family: 'Dancing Script', cursive;
      text-transform: none;
      font-size: 1.2rem;
      font-weight: 500;
      letter-spacing: normal;
      color: #fff;
      padding: .7rem 1.8rem;
    }
    #btnWhatsapp svg,
    #btnEscuchar svg {
      margin-right: 4px; /* Pequeño ajuste para el icono */
    }


    /* === SECCIONES Y SEPARADORES === */
    section.sectioned{
      padding:80px 0; /* Espacio entre secciones reducido */
      position:relative
    }
    section.sectioned::before{
      content: url("data:image/svg+xml,%3Csvg width='80' height='20' viewBox='0 0 80 20' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M40 10L80 10' stroke='%23a88552' stroke-opacity='0.5'/%3E%3Cpath d='M40 10L0 10' stroke='%23a88552' stroke-opacity='0.5'/%3E%3Cpath d='M45.5 18.5C45.5 18.5 42.5 10 40 10C37.5 10 34.5 1.5 34.5 1.5' stroke='%23a88552' stroke-opacity='0.5'/%3E%3Cpath d='M34.5 18.5C34.5 18.5 37.5 10 40 10C42.5 10 45.5 1.5 45.5 1.5' stroke='%23a88552' stroke-opacity='0.5'/%3E%3C/svg%3E%0A");
      position:absolute; top:20px; left:50%; transform:translateX(-50%);
    }

    /* === SLIDER === */
    .slider{
      position:relative; 
      background: var(--card);
      padding: 12px;
      border-radius: var(--radius); 
      box-shadow: var(--shadow-medium);
    }
    .slides-container {
      overflow: hidden;
      position: relative;
      border-radius: calc(var(--radius) - 6px);
    }
    .slides{display:flex; transition:transform .6s cubic-bezier(.22,.75,.18,1); }
    .slide{min-width:100%; height:70svh; position:relative;}
    .slide img{width:100%; height:100%; object-fit:cover; border-radius: 0;}
    .slide.is-active img{transform:scale(1.03)}
    .overlay{
      position:absolute; left:16px; right:16px; bottom:16px;
      background:rgba(255,255,255,.85);
      backdrop-filter: blur(6px);
      border:1px solid var(--hairline); color:var(--ink);
      padding:16px; border-radius:var(--radius); box-shadow:var(--shadow-soft);
      opacity:0; transform:translateY(10px); transition:opacity .6s ease, transform .6s ease .1s;
    }
    .slide.is-active .overlay{opacity:1; transform:translateY(0)}
    .nav-btn{position:absolute; top:50%; transform:translateY(-50%); z-index:10; width:44px; height:44px; border-radius:50%; border:0; background:rgba(255,255,255,.8); display:grid; place-items:center; cursor:pointer; box-shadow:var(--shadow-soft); transition: var(--transition);}
    .nav-btn:hover { background: #fff; transform: translateY(-50%) scale(1.05); }
    .nav-btn.prev{left:16px} .nav-btn.next{right:16px}
    .dots{position:absolute; inset:auto 0 32px; display:flex; gap:10px; justify-content:center; z-index:5}
    .dots button{width:10px; height:10px; border-radius:50%; border:1.5px solid #fff; background:transparent; transition: var(--transition); box-shadow: 0 1px 3px rgba(0,0,0,.2);}
    .dots button[aria-current="true"]{background: #fff;}

    /* === TARJETAS DE CONTENIDO (LUGARES, ITINERARIO) === */
    .grid{display:grid; gap:24px}
    @media(min-width:720px){.grid.two{grid-template-columns:repeat(2,1fr)}}
    .card{
      background:var(--card); 
      border-radius:var(--radius); 
      box-shadow:var(--shadow-soft); 
      transition:transform .25s ease, box-shadow .25s ease;
      will-change: transform, box-shadow;
      overflow: hidden;
    }
    .grid.two .card img {
      height: 250px;
      width: 100%;
      object-fit: cover;
    }
    .card:hover{transform:translateY(-5px); box-shadow:var(--shadow-medium)}
    .card .body{padding:24px}
    .card h3 { font-family: 'Playfair Display', serif; margin: 0 0 8px; color: var(--accent); }

    /* === TIMELINE (ITINERARIO) === */
    .timeline{position:relative; max-width:900px; margin:40px auto 0;}
    .timeline::before{content:""; position:absolute; left:45px; top:10px; bottom:10px; width:2px; background:var(--brand-light);}
    .tl-item{display:grid; grid-template-columns:90px 1fr; gap:16px; align-items:center; position:relative; margin-bottom:20px}
    .tl-time{
      font-weight:600; font-size: 1.1rem; color: var(--accent); 
      text-align:left;
      position:relative; z-index:2;
    }
    .tl-dot{position:absolute; left:45px; top:50%; transform:translate(-50%, -50%); width:16px; height:16px; border-radius:50%; background:var(--bg); border: 3px solid var(--brand-light); z-index:1}
    .tl-card.card{box-shadow:var(--shadow-soft); padding:20px; will-change: none; }
    .tl-card.card:hover { transform: none; box-shadow: var(--shadow-medium); }
    .tl-card .body{padding:0}
    .tl-card .place{color:var(--muted); font-size:.95rem}
    .tl-card b { color: var(--accent); }

    /* === FORMULARIO RSVP === */
    .rsvp-card{
      max-width:600px; margin:0 auto; padding:32px; background:var(--card); 
      border-radius:var(--radius); box-shadow:var(--shadow-medium);
    }
    .field{display:flex; flex-direction:column; gap:.5rem; margin-bottom: 1.2rem;}
    .field span { font-weight: 600; color: var(--accent); }
    .input,.select{
      width:100%; padding:12px 16px; border-radius:10px; 
      border:1.5px solid #e0e0e0; background:#f9f9f9; 
      box-shadow:none; outline:none; transition: var(--transition);
      font-size: 1rem;
    }
    .input:focus,.select:focus{box-shadow:0 0 0 3px var(--brand-light); border-color:var(--brand)}
    .helper{font-size:.9rem; color:var(--muted); text-align: center; margin-top: 16px;}
    
    /* === REPRODUCTOR DE MÚSICA === */
    .player{position:fixed; right:16px; bottom:16px; z-index:50; display:flex; align-items:center; gap:.6rem; padding:.5rem; background:#fff; border-radius:999px; box-shadow:var(--shadow-medium)}
    .disc{width:32px; height:32px; border-radius:50%; background:radial-gradient(circle at 50% 50%, #444 0 8px, #222 9px 50%, #111 51% 100%), repeating-radial-gradient(circle at 50% 50%, rgba(255,255,255,.08) 0 2px, rgba(0,0,0,.15) 2px 4px); position:relative; flex:0 0 32px; box-shadow:inset 0 1px 4px rgba(0,0,0,.2); animation:spin 5s linear infinite; animation-play-state:paused;}
    .disc::after{content:""; position:absolute; width:8px; height:8px; border-radius:50%; background:var(--brand); top:50%; left:50%; transform:translate(-50%,-50%);}
    .player.playing .disc{animation-play-state:running}
    @keyframes spin{to{transform:rotate(360deg)}}
    .player .label,.player .sub{display:none}
    .icon-btn{width:40px; height:40px; display:grid; place-items:center; border-radius:50%; border:0; background:transparent; cursor:pointer; transition: var(--transition);}
    .icon-btn:hover { background-color: #f0f0f0; }
    .icon{width:20px; height:20px; display:block}
    .icon path{fill:var(--ink)}

    /* === FOOTER === */
    footer.signature{ text-align:center; color:var(--muted) }
    footer.signature em{ 
      font-family:'Dancing Script', cursive; 
      font-size:clamp(28px, 6vw, 42px); 
      color:var(--brand);
      font-weight: 500;
    }

    /* === ANIMACIONES === */
    .reveal{opacity:0; transform:translateY(20px); transition:opacity .8s ease, transform .8s ease; will-change: opacity, transform;}
    .reveal.visible{opacity:1; transform:none}
    
    @media (prefers-reduced-motion:reduce){*{animation:none!important; transition:none!important; scroll-behavior:auto!important}}
  </style>
</head>
<body>
  <header class="hero" id="hero">
    <div class="wrap reveal">
      <span class="badge">NUESTRA BODA</span>
      <h1>Isabel & Alejandro</h1>
      <p class="sub" id="eventDate">6 de Diciembre de 2025 · 1:30 pm</p>

      <div id="countdown" class="countdown" aria-live="polite">
        <div class="time-box"><span class="num" id="cd-days">00</span><span class="label">Días</span></div>
        <div class="time-box"><span class="num" id="cd-hours">00</span><span class="label">Horas</span></div>
        <div class="time-box"><span class="num" id="cd-mins">00</span><span class="label">Minutos</span></div>
        <div class="time-box"><span class="num" id="cd-secs">00</span><span class="label">Segundos</span></div>
      </div>

      <div class="cta-row">
        <button class="btn secondary" id="btnHistoria" aria-label="Ir a Nuestra Historia">
          Nuestra Historia
        </button>
        <button class="btn secondary" id="btnCalendar" title="Agregar al calendario" aria-label="Añadir al calendario">
          Añadir al Calendario
        </button>
      </div>
    </div>
  </header>

  <div class="player" id="player" role="region" aria-label="Reproductor de música">
    <div class="disc" aria-hidden="true"></div>
    <button class="icon-btn" id="btnMusic" aria-label="Reproducir / Pausar" title="Reproducir / Pausar">
      <svg class="icon" id="icoPlay" viewBox="0 0 24 24" aria-hidden="true"><path d="M8 5v14l11-7z"/></svg>
      <svg class="icon" id="icoPause" viewBox="0 0 24 24" aria-hidden="true" style="display:none"><path d="M6 5h4v14H6zm8 0h4v14h-4z"/></svg>
    </button>
    <button class="icon-btn" id="btnMute" aria-label="Silenciar / Activar" title="Silenciar / Activar">
      <svg class="icon" id="icoVol" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 10v4h4l5 4V6l-5 4H4zm12.5 2a4.5 4.5 0 0 0-2.3-3.9v7.8a4.5 4.5 0 0 0 2.3-3.9z"/></svg>
      <svg class="icon" id="icoMute" viewBox="0 0 24 24" aria-hidden="true" style="display:none"><path d="M16.5 12a4.5 4.5 0 0 1-2.3 3.9V8.1A4.5 4.5 0 0 1 16.5 12zM4 10v4h4l5 4V6l-5 4H4zm12.6 6.2 1.4 1.4L21.6 18l-1.8-1.8L21.6 14l-1.4-1.4-1.8 1.8-1.8-1.8L15.2 14l1.8 1.8-1.8 1.8z"/></svg>
    </button>
  </div>
  
  <main>
    <section id="historia" class="wrap reveal sectioned">
      <h2 class="title">Nuestra Historia</h2>
      <p class="subtitle">Un viaje a través de los momentos que nos trajeron hasta aquí. Desliza para revivir nuestros recuerdos más queridos.</p>

      <div class="center-actions" style="margin-bottom: 40px;">
        <button class="btn primary" id="btnEscuchar" aria-label="Reproducir nuestra canción">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v11.55A4 4 0 1 1 10 18V7h9V3h-7z"/></svg>
          Reproducir Nuestra Canción
        </button>
      </div>

      <div class="slider" data-slider>
        <div class="slides-container">
          <ul class="slides" data-slides>
            <li class="slide">
              <img src="assets/imagenes/historia-1.jpg" alt="Cuando nos conocimos" loading="lazy" decoding="async"/>
              <div class="overlay"><b>02 de Septiembre, 2025</b><p style="margin:4px 0 0;">Cuando nos conocimos. Una mirada bastó para empezar la aventura.</p></div>
            </li>
            <li class="slide">
              <img src="assets/imagenes/historia-2.jpg" alt="Primera cita" loading="lazy" decoding="async"/>
              <div class="overlay"><b>16 de Octubre, 2025</b><p style="margin:4px 0 0;">Nuestra primera cita. Entre risas, café y mil planes por delante.</p></div>
            </li>
            <li class="slide">
              <img src="assets/imagenes/historia-3.jpg" alt="Primer viaje" loading="lazy" decoding="async"/>
              <div class="overlay"><b>08 de Enero, 2026</b><p style="margin:4px 0 0;">El primer viaje. Descubrimos que el mejor destino es estar juntos.</p></div>
            </li>
            <li class="slide">
              <img src="assets/imagenes/historia-4.jpg" alt="La propuesta" loading="lazy" decoding="async"/>
              <div class="overlay"><b>12 de Febrero, 2027</b><p style="margin:4px 0 0;">¡Dijo que sí! El comienzo de una nueva etapa para siempre.</p></div>
            </li>
          </ul>
        </div>
        <button class="nav-btn prev" data-prev aria-label="Anterior">⟵</button>
        <button class="nav-btn next" data-next aria-label="Siguiente">⟶</button>
        <div class="dots" data-dots></div>
      </div>
    </section>

    <section id="lugares" class="wrap reveal sectioned">
      <h2 class="title">La Celebración</h2>
      <p class="subtitle">Estos son los lugares donde celebraremos nuestro amor. Toca en cada uno para ver la ubicación en el mapa.</p>
      <div class="grid two">
        <article class="card reveal">
          <img src="assets/imagenes/ceremonia.jpg" alt="Lugar de la ceremonia" loading="lazy" decoding="async"/>
          <div class="body">
            <h3>Ceremonia</h3>
            <p class="helper">Iglesia Retalhuleu<br>Llegar 15 minutos antes. Hay estacionamiento frente a la entrada.</p>
            <div class="center-actions">
              <a class="btn primary" href="https://maps.google.com/?q=Iglesia%20Retalhuleu" target="_blank" rel="noopener" aria-label="Ver ubicación de Iglesia Retalhuleu">
                Ver Ubicación
              </a>
            </div>
          </div>
        </article>
        <article class="card reveal">
          <img src="assets/imagenes/recepcion.jpg" alt="Lugar de la recepción" loading="lazy" decoding="async"/>
          <div class="body">
            <h3>Recepción</h3>
            <p class="helper">Salón Las Morenas<br>Acompáñanos a la cena, el brindis y el baile para celebrar.</p>
            <div class="center-actions">
              <a class="btn primary" href="https://maps.google.com/?q=Salon%20Las%20Morenas" target="_blank" rel="noopener" aria-label="Ver ubicación de Salón Las Morenas">
                Ver Ubicación
              </a>
            </div>
          </div>
        </article>
      </div>
    </section>

    <section id="itinerario" class="wrap reveal sectioned">
      <h2 class="title">Itinerario</h2>
      <p class="subtitle">Planeamos cada momento con mucho cariño para que disfrutes este día con nosotros.</p>
      <ul class="timeline">
        <li class="tl-item reveal">
          <div class="tl-time">6:00 pm</div>
          <div class="tl-card card"><div class="body"><b>Ceremonia Religiosa</b><div class="place">Iglesia Retalhuleu</div></div></div>
          <span class="tl-dot" aria-hidden="true"></span>
        </li>
        <li class="tl-item reveal">
          <div class="tl-time">8:00 pm</div>
          <div class="tl-card card"><div class="body"><b>Recepción y Cena</b><div class="place">Salón Las Morenas</div></div></div>
          <span class="tl-dot" aria-hidden="true"></span>
        </li>
        <li class="tl-item reveal">
          <div class="tl-time">10:30 pm</div>
          <div class="tl-card card"><div class="body"><b>Corte del Pastel</b><div class="place">¡El momento más dulce de la noche!</div></div></div>
          <span class="tl-dot" aria-hidden="true"></span>
        </li>
        <li class="tl-item reveal">
          <div class="tl-time">12:00 am</div>
          <div class="tl-card card"><div class="body"><b>Despedida y Agradecimientos</b><div class="place">Gracias por ser parte de nuestra historia. 💕</div></div></div>
          <span class="tl-dot" aria-hidden="true"></span>
        </li>
      </ul>
    </section>

    <section id="rsvp" class="wrap reveal sectioned">
      <h2 class="title">Confirmar Asistencia</h2>
      <p class="subtitle">Tu presencia es nuestro mayor regalo. Por favor, confirma tu asistencia antes del 6 de Noviembre de 2025.</p>

      <form class="rsvp-card" id="rsvpForm">
        <div class="field">
          <span>Nombre Completo</span>
          <input class="input" id="guestName" name="guestName" type="text" placeholder="Escribe tu nombre y apellido" required />
        </label>
        <div class="field">
          <span>Acompañantes</span>
          <select class="select" id="companions" name="companions">
            <option value="0">Asistiré sin acompañantes</option>
            <option value="1">Asistiré con 1 acompañante</option>
            <option value="2">Asistiré con 2 acompañantes</option>
            <option value="3">Asistiré con 3 acompañantes</option>
            <option value="4">Asistiré con 4 acompañantes</option>
            <option value="5">Asistiré con 5 acompañantes</option>
            <option value="-1">Lamentablemente no podré asistir</option>
          </select>
        </div>
        <div style="margin-top: 24px; text-align:center;">
          <button type="submit" class="btn primary" id="btnWhatsapp" aria-label="Confirmar por WhatsApp">
             <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.5 3.5a10 10 0 0 0-16.2 11.3L3 21l6.4-1.3A10 10 0 0 0 20.5 3.5Zm-1.1 13a8 8 0 0 1-11.8 1.5l-.3-.2-3 .6.6-2.9-.2-.3A8 8 0 1 1 19.4 16.5ZM8.9 7.9c.2-.5.4-.5.7-.5h.6c.2 0 .5 0 .7.5s.9 1.5.9 1.6.1.4 0 .6-.2.4-.4.6-.4.5-.2.9c.2.4 1 1.6 2.1 2.6 1.5 1.3 2.7 1.7 3.1 1.9s.5 0 .7-.2.8-.9 1-1.2.4-.2.6-.1.6.3 1.4.7 1.2.6 1.4.9.1.9-.2 1.5c-.3.6-1.2 1.1-1.6 1.1s-.9.2-3-.8a13.6 13.6 0 0 1-3.8-2.4 12.2 12.2 0 0 1-2.2-2.6c-.8-1.2-1.1-2.1-1.2-2.4-.2-.4 0-.8.1-1s.5-1.2.6-1.4Z"/></svg>
            Confirmar por WhatsApp
          </button>
          <p class="helper">O si prefieres, puedes llamar al <a href="tel:44649407">44 64 94 07</a>.</p>
        </div>
      </form>
    </section>

    <footer class="signature reveal sectioned">
      <div>Con todo nuestro cariño,</div>
      <em>Isabel & Alejandro</em>
    </footer>
  </main>

  <audio id="bgMusic" src="assets/imagenes/musica/fondo.mp3" preload="auto" loop></audio>
  <audio id="voiceInvite" src="assets/musica/invitacion.mp3" preload="auto"></audio>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const $  = (s, el=document) => el.querySelector(s);
      const $$ = (s, el=document) => [...el.querySelectorAll(s)];

      $('#btnHistoria')?.addEventListener('click', ()=> $('#historia').scrollIntoView());

      const slider = $('[data-slider]'), track=slider?.querySelector('[data-slides]');
      const slides = $$('.slide', slider), dotsC=slider?.querySelector('[data-dots]');
      const prev   = slider?.querySelector('[data-prev]'), next=slider?.querySelector('[data-next]');
      let i=0, x0=null, autoTimer=null;

      function markActive(prevIdx){
        if(!slides[i]) return;
        if (typeof prevIdx === 'number'){
          slides[prevIdx]?.classList.add('leaving');
          setTimeout(()=> slides[prevIdx]?.classList.remove('leaving'), 550);
        }
        slides.forEach(s=> s.classList.remove('is-active'));
        slides[i].classList.add('is-active');
        if(dotsC) [...dotsC.children].forEach((d,idx)=> d.setAttribute('aria-current', idx===i));
      }
      function go(n){
        if(!track || !slides.length) return;
        const prevIdx=i;
        i = (n + slides.length) % slides.length;
        track.style.transform = `translateX(${-i*100}%)`;
        markActive(prevIdx);
      }
      function auto(){ clearInterval(autoTimer); autoTimer=setInterval(()=>go(i+1), 6000); }
      if (slides.length > 0 && dotsC) {
        dotsC.innerHTML = ''; 
        slides.forEach((_s, idx)=>{
          const b=document.createElement('button');
          b.type='button'; b.setAttribute('aria-label',`Ir a la foto ${idx+1}`);
          b.addEventListener('click',()=>{go(idx);auto();});
          dotsC.appendChild(b);
        });
        markActive(); auto();
      }
      prev?.addEventListener('click', ()=>{ go(i-1); auto(); });
      next?.addEventListener('click', ()=>{ go(i+1); auto(); });
      track?.addEventListener('pointerdown', e=>{ x0 = e.clientX; track.setPointerCapture(e.pointerId); clearInterval(autoTimer); });
      track?.addEventListener('pointerup',   e=>{ if(x0===null) return; const dx=e.clientX - x0; x0=null; if(Math.abs(dx) > 40) go(i + (dx<0?1:-1)); auto(); });
      window.addEventListener('keydown', e=>{ if(e.key==='ArrowRight'){go(i+1);auto();} if(e.key==='ArrowLeft'){go(i-1);auto();} });

      const bg=$('#bgMusic'), voice=$('#voiceInvite');
      const player=$('#player'), playerState=$('#playerState');
      const icoPlay=$('#icoPlay'), icoPause=$('#icoPause'), icoVol=$('#icoVol'), icoMute=$('#icoMute');
      let bgStarted=false;

      function updBtns(){
        if(!bg || !player) return;
        const p=bg.paused, m=bg.muted;
        player.classList.toggle('playing',!p);
        icoPlay.style.display=p?'block':'none';
        icoPause.style.display=p?'none':'block';
        icoVol.style.display=m?'none':'block';
        icoMute.style.display=m?'block':'none';
      }
      function tryStartBg(){
        if(!bgStarted && bg){ bg.volume=.6; bg.play().then(()=>{bgStarted=true;updBtns();}).catch(()=>{}); }
      }
      $('#btnMusic')?.addEventListener('click', ()=>{ if(bg.paused) bg.play(); else bg.pause(); updBtns(); });
      $('#btnMute')?.addEventListener('click', ()=>{ bg.muted=!bg.muted; updBtns(); });
      $('#btnEscuchar')?.addEventListener('click', ()=>{ if(!bgStarted || bg.paused){ tryStartBg(); } else { bg.pause(); } updBtns(); });
      document.addEventListener('click', tryStartBg, {once:true});
      bg?.addEventListener('play', updBtns); bg?.addEventListener('pause', updBtns);
      voice?.addEventListener('play', ()=>{ if(!bg.paused){ bg.pause(); updBtns(); } });

      const target=new Date('2025-12-06T13:30:00'),
            d=$('#cd-days'), h=$('#cd-hours'), m=$('#cd-mins'), s=$('#cd-secs');
      let countdownInterval = null;
      function tick(){
        const now=new Date(); let diff=target-now;
        if (diff<=0){ 
          d.textContent=h.textContent=m.textContent=s.textContent='00'; 
          clearInterval(countdownInterval);
          return; 
        }
        const dd=Math.floor(diff/86400000); diff%=86400000;
        const hh=Math.floor(diff/3600000);  diff%=3600000;
        const mm=Math.floor(diff/60000);    diff%=60000;
        const ss=Math.floor(diff/1000);
        d.textContent=String(dd).padStart(2,'0');
        h.textContent=String(hh).padStart(2,'0');
        m.textContent=String(mm).padStart(2,'0');
        s.textContent=String(ss).padStart(2,'0');
      }
      if(d && h && m && s) {
        tick(); 
        countdownInterval = setInterval(tick,1000);
      }
      
      $('#btnCalendar')?.addEventListener('click', ()=>{
        const start=new Date('2025-12-06T13:30:00'), end=new Date(start.getTime()+4*60*60*1000);
        const pad=n=>String(n).padStart(2,'0');
        const fmt=d=>d.getUTCFullYear()+pad(d.getUTCMonth()+1)+pad(d.getUTCDate())+'T'+pad(d.getUTCHours())+pad(d.getUTCMinutes())+'00Z';
        const ics=['BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//Creative Studio//Boda//ES','BEGIN:VEVENT','UID:'+Date.now()+'@boda','DTSTAMP:'+fmt(new Date()),'DTSTART:'+fmt(start),'DTEND:'+fmt(end),'SUMMARY:Boda de Isabel & Alejandro','LOCATION:Iglesia Retalhuleu; Recepción: Salón Las Morenas','DESCRIPTION:Acompáñanos en nuestro gran día 💕','END:VEVENT','END:VCALENDAR'].join('\r\n');
        const blob=new Blob([ics],{type:'text/calendar'}), url=URL.createObjectURL(blob);
        const a=document.createElement('a'); a.href=url; a.download='Boda-Isabel-Alejandro.ics'; document.body.appendChild(a); a.click(); a.remove();
        setTimeout(()=>URL.revokeObjectURL(url),5000);
      });

      const WHATSAPP_NUMBER='44649407';
      $('#rsvpForm')?.addEventListener('submit', (e)=>{
        e.preventDefault();
        const name=$('#guestName').value.trim();
        const companions=$('#companions').value;
        if(!name){ alert('Por favor, escribe tu nombre.'); return; }
        const compText = companions==='-1' ? 'Lamentablemente no podré asistir.'
          : (companions==='0' ? 'Confirmo mi asistencia (sin acompañantes).'
          : `Confirmo mi asistencia con ${companions} acompañante${companions==='1'?'':'s'}.`);
        const msg=`¡Hola! Soy ${name}. ${compText}`;
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`,'_blank');
      });

      document.querySelectorAll('img').forEach(img=>{
        img.addEventListener('error', ()=>{
          const missing=img.getAttribute('src')||'';
          const ph=document.createElement('div');
          ph.style.cssText='display:grid;place-items:center;background:#f1f1f1;color:#b00;font:12px/1.2 system-ui,Arial;height:100%;text-align:center;padding:10px';
          ph.textContent='No se encontró:\n'+missing;
          img.replaceWith(ph);
          console.warn('Imagen no encontrada:', missing);
        }, {once:true});
      });

      const io=new IntersectionObserver((entries)=>{ entries.forEach(en=>{ if(en.isIntersecting){ en.target.classList.add('visible'); io.unobserve(en.target);} }); }, {threshold:.1});
      $$('.reveal').forEach(el=> io.observe(el));
    });
  </script>
</body>
</html>
